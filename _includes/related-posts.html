<!-- Related Posts with Enhanced Accessibility and Performance -->
<section class="related-posts" aria-labelledby="related-posts-heading">
  <h2 id="related-posts-heading">{{ site.data.settings.related_posts }}</h2>
  {% assign listed_posts_urls = page.url | split: ' ' %}
  <ul class="related-posts-list">
    {% for tag in page.tags %}
      {% for mypost in site.tags[tag] limit:3 %}
        {% if listed_posts_urls contains mypost.url %}
        {% else %}
          <li class="related-post-item">
            <article class="related-post-card">
              <a href="{{ mypost.url | relative_url }}" class="related-post-link">
                <div class="related-post-thumbnail">
                  {% if mypost.image %}
                    <img
                      src="{{ '/assets/img/' | append: mypost.image | relative_url }}"
                      alt="{% if mypost.image-alt %}{{ mypost.image-alt }}{% else %}Thumbnail for {{ mypost.title }}{% endif %}"
                      loading="lazy"
                      width="300"
                      height="200">
                  {% endif %}
                </div>
                <div class="related-post-content">
                  <h3 class="related-post-title">{{ mypost.title }}</h3>
                  {% if mypost.excerpt %}
                    <p class="related-post-excerpt">{{ mypost.excerpt | strip_html | truncatewords: 15 }}</p>
                  {% endif %}
                  <time class="related-post-date" datetime="{{ mypost.date | date_to_xmlschema }}">
                    {{ mypost.date | date: "%B %-d, %Y" }}
                  </time>
                </div>
              </a>
            </article>
          </li>
          {% assign listed_posts_urls = listed_posts_urls | push: mypost.url %}
        {% endif %}
      {% endfor %}
    {% endfor %}
  </ul>
</section>
